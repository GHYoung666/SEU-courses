# 集成电路CAD

建议直接复习PPT中的思考题，很有参考价值，详情请见回忆录。

> 孙：这门课听说上一届考的很容易，但是实际考下来感觉比VLSI要难。题目数量也很多，也比较难算。

## 2023集成电路CAD考试回忆录

题型为八道大题，下面孙寒石学长整理的资料（我稍做了些修改）基本没用上，大伙可以以刷题为主，但是还是警惕老师可能会变题库

一、你最后的大作业名称是什么（模拟+数字）？设计过程中对应了CAD软件设计的哪些步骤？你为什么会这样选题？10‘

二、给了一个电路图（其中包括信号源、电容、电阻）（1）描述非线性电路方程的分析方法？（2）请写出该电路图的稳态节点电压方程？

三、一个逻辑门的图，一张输入信号波形图，给了ΔT以及ΔR、ΔF，分别画出两个波形

四、运用路径敏化法和D算法分别分析电路中存在的cs-a-0现象

五、一张逻辑电路图，请写出图中的真值表以及三值真值表，并判断电路中可能存在的竞争冒险现象

六、一张电路图：CMOS静态+传输门结构（1）写出真值表，并列出方程（异或）（2）画出该结构的PLA电路以及E/D PLA电路（3）画出该结构的十管CMOS图

七、短路连接，前后逻辑是否发生变化，是什么导致的。图为书本P143——“桥接故障引起的功能变化”

八、有约束的左端布线算法（1）确定通道容量（2）布线

## Chapter 1：Introduction

- VLSI 发展方向：亚0.1微米（纳米）技术：低功耗、高速度、高集成度；系统的芯片集成（SOC）；IC－>IS

### 试述 VLSI 的设计思想和设计方法？
- VLSI 的设计思想：分层、分级的设计和管理，将复杂模块化为简单模块，各级间的借口明确定义并给予验证
- VLSI 的设计方法：
	- 自顶向下（Top Down）：将要设计的 VLSI 系统逐级分解成较简单的功能，直至达到可进行高效设计的、足够简单的功能块，每一级将要完成的功能以及上一级和下一级的接口均有严格的规定；
	- 自底向上（Bottom Up）：根据现有的简单功能块或积木块单元，逐级向上组合，直至实现 VLSI 的总体功能。同样，每一级的功能及尺寸以及与上下级接口均有严格定义。
	两种设计方法均体现了VLSI的设计思想；实际上VLSI由LSI组成，LSI由MSL组成，MSL由LSL组成；复杂电路总可以分解为较简单的电路。


### CAD 软件涉及哪些内容？
各阶段均有不同的CAD软件。 
- **逻辑设计阶段：** 逻辑综合、逻辑模拟、逻辑图的自动输入；
- **电路设计阶段：** 电路分析、时域分析；
- **版图设计阶段：** 逻辑划分、自动布局布线；
- **工艺设计阶段：** 工艺模拟、器件分析。

### EDIF、CIF 等格式分别适用于哪些方面？
**EDIF：**
现在的 CAD 工具在电路设计完成之后可以生成 EDIF 电路级规范 EDIF 在电路图绘制，电路的行为及结构文本描述、逻辑描述、PCB 设计、 ASIC 版图设计和其他分析综合工具之间建立起一个公共的双向标准。EDIF 以 ASCII 字符为基础，是一种公开的非专有的互换格式，可向上兼容，不同设计系统的设计数据可以通过 EDIF 格式互相转换。

**CIF：**
版图级规范 CIF 以 ASCII 字符为基础，是一种由字符组成的可读文件。CIF 采用层次式结构的图形描述，基本的描述功能以命令形式出现。设计师容易阅读、修改、组合和跟踪，通过反复循环调用这些图形符号，可以完整的描述一个复杂的 VLSI 电路版图。

### VLSI 设计流程及各设计阶段的内容
P12页的图

VLSI 的 Top Down 方式的设计流程包括行为设计、结构设计、逻辑设计、电路设计、版图设计。
- 高层综合包括电路的行为级描述和结构设计，其目标是在满足性能、面积和功耗的约束条件下，设计一个代价最小的硬件结构，得到功能的寄存器级最佳设计；
- 逻辑综合需要门级的仿真及布图设计，取得面积、速度和功耗相对折中的指标；
- 物理综合就是版图设计及布图设计，包括逻辑划分、布局、布线，还有设计规则检查、电学规则检查、版图与电路图的校验、版图参数提取和后仿真。

按照设计流程，通常将系统和功能的设计及结构和电路的设计成为前端设计，版图设计称为后端设计。

### 可靠性和可测性设计
设计、试制和生产IC难免在各个环节会出现一些意想不到的差错，如何检测这些错误以保证产品的性能和质量，主要的手段还是借助于测试。为了在设计阶段把关，在必要时要加入可测性可可靠性设计的内容。

**可测性：**
可测性设计的基本思想是在电路的设计阶段就考虑到测试模块是整个电路的一部分，从而把 CAT 和 CAD 结合起来。主要目的是解决芯片的测试和分析问题。目标是所设 计芯片的可控性和可观测性。
- IC 测试包括三个最基本的测试项目，即直流特性测试，交流特性测试和逻辑功能测试。
- 直流特性测试是一种检验芯片好坏和考察芯片可靠性的简易途径。直流特性测试包括输入特性、输出特性、转移特性和功能项目。
- 交流特性测试又称动态特性测试，主要测试脉冲的传输特性。在给定的输入波形时，测出输出波形的上升、下降、延时等参数。
- 逻辑功能测试通过设计生成测试图形、测试码、测试矢量，得到实际测试结果。

**可靠性：**
可靠性设计是指在进行功能、特性设计的同时，针对电路在以后的工作和应用环境，以及在规定的工作时间内可能出现的失效模式采取相应的设计技术，使这些失效模式能 得到控制或消除。
- 可靠性是指IC芯片在规定的条件下和规定的时间内，完成规定功能的概率。
- 可靠性设计就是研究如何从设计的角度去改善和保证IC的可靠性。
- 包括电路设计的元件和数值留有一定的冗余度；增加ESD保护电路；合理布局的热设计；
- 合理布线以防止串扰和电迁移等等。

## Chapter 2：专用集成电路 CAD 设计基础

- 双极(BJT)：多子器件，电流大，驱动大；MOS：少子器件，面积小速度快；BiMos：速度和功率的平衡；DMOS：双扩散MOS，高压大功率；BCD：现在流行的工艺
- 模拟集成电路设计特点：负反馈、差分放大器和有源负载放大器、偏置电路用恒压/流源、有源器件多、用比例电阻
- 数字电路包括：双极逻辑电路，MOS，SOS（减小面积/降低电容），GaAs 电路（电子迁移率较高）
- ASIC的主要结构形式包括行式结构、积木块结构、规则阵列结构
- ASIC的主要优点：降低了产品的综合成本；提高了产品可靠性；提高了产品的保密程度和竞争能力；降低了电子产品的功耗；提高了电子产品的工作速度；大大减少了电子产品的体积和重量。
- 行式结构：芯片中央为单元阵列和布线通道，输入输出单元在芯片的四周。*门阵列和标准单元都是行式结构*，具有一定高度的限制。单元的信号引线从单元的上下两边引出，电源、 地线从单元的左右两边引出，并且它们的位置、线宽都有严格的规定。行式结构的布线采用两边或四边布线通道模型， 通常采用面向布线区的布线方式。所谓面向布线区的布线方式是指布线的优化是针对各布线通道实现的。
- 积木块结构是宏单元的布图结构，积木块单元突破了单元高度的限制，使单元的设计灵活性大为增强，并且单元的优化程度更高。标准专用电路通常采用积木块结构，如单片机芯片。积木块结构的布线通常将连线按数据流和控制流进行分类，采用面向或网的布线方法。所谓面向线网的布线方法是指布线的优化是按照线网顺序进行。
- 规则阵列结构既可以单独构成电路逻辑，又可以作为ASIC的一个单元。规则阵列结构一般为两级阵列，分别为“与阵列”和“或阵列” 。*ROM和PLA阵列是规则阵列结构，大多采用MOS 结构*。MOS集成电路中，常用“或非—或非”阵列结构 或“与非—与非”阵列结构代替“与—或”阵列结构 ，均有同相和反相输入和输出。
- 半定制电路的结构：固定门阵列（FIXED GATE ARRAY），可编程逻辑器件（PLD） 目前较为成熟的PLD有PLA、PROM（与固定）、PAL（或固定）、 GAL（有宏单元）和EPLD，现场可编程门阵列FPGA
- JK触发器：$Q_{n+1}=JQ_n+K\bar{Q}_n$
- 门阵列：固定门阵列、优化门阵列、CMOS门阵列
- 优化门阵列是属于全定制集成电路。优化门阵列是一种不规则的门阵列结构。 所谓不规则是指它的单元行的宽度不完全相同，即每行的单元数有多有少，布线通道的容量不完全相同。

### 全定制、半定制电路的区分，举例。
#### 全定制电路
- 全定制 ASIC 电路，是指对于为某一用户设计、制造的集成电路，从电路图输入开始，完成逻辑或电路验证、版图生成、掩膜制备到芯片制作的全套集成电路研制过程。
- 为了缩短设计、制作周期，设计过程采用 CAD 技术，制作过程采用成熟的半导体集成电路工艺，集成电路版图采用行式结构、积木块结构、规则阵列结构或者是其他几何结构的组合。
- 所以，全定制设计方法是设计工艺所需要的全套掩膜版，有标准单元法、功能块法、优化阵列法等。

#### 半定制电路
- 与全定制不同，半定制电路的大部分设计和制备过程并不是针对某一特定用户的。在接到 ASIC 的设计任务时，集成电路的大部分或全部工艺过程都已被完成。对于某一 ASIC 用户只需通过简单的设计，制备或“烧结”即可获得用户所需的 ASIC。
- 半定制电路具有一定的“母片”结构
- 半定制设计方法是只设计全套掩膜版中的一块或数块，典型的方法有固定门阵列法和可编程阵列法等
- 对于半定制电路，按照半成品的形式又可划分为两种：一种是半定制电路的初始基础是硅材料母片， 另一种是半定制电路的初始基础是已封装好的电路

### ASIC 的主要结构有哪些？
ASIC 的主要结构有行式结构、积木块结构、规则阵列结构。 行式结构是芯片中央为单元阵列和布线通道，输入/输出单元在芯片四周。
- 行式结构的典型应用是门阵列和标准单元阵列。 
- 所谓的积木块结构是一种大的单元的布图结构，这些单元可以是一种 CAD 产品的规则结构，也可以是一块优化门阵列，还可以是人工精心设计的电路单元或者存储器阵列。标准专用电路通常采用积木块结构。 
- 规则阵列结构也是常用的结构，最典型的类型如 ROM和 PLA，这种结构既可以单独构成电路逻辑，也可以作为 ASIC 的一个单元。



## Chapter3：电路分析
### 线性电路的直流分析
$$YV=I$$
### 线性电路的交流分析
$$\text{复数形式的} \quad YV=I$$
### 非线性电路直流、交流分析
牛顿-拉夫森迭代（N-R 法）$$x^{k+1}=x^k-\frac{f(x^k)}{\left.\frac{\partial f}{\partial x}\right|_x^k}$$
$$I_D=I_S(e^{V_D/V_t}-1)$$
对于非线性方程组的解法公式见 P92，Jacobi 矩阵，二极管等效电路/伴随模型

### 瞬态电路分析
$$i_C=C\frac{dV}{dt}\qquad v_L=L\frac{di_L}{dt}$$
电容电感伴随模型、差分方程的书写

### 三极管的H参数模型
见书 P104

## Chapter4：逻辑模拟
*逻辑模拟的两个主要作用：一是评价系统；二是分析故障。*
- 冒险包括静态0-冒险（稳定0出1），静态1-冒险（稳定1出0），动态0-冒险（信号0-1变化时出现上下抖动），动态1-冒险（信号1-0变化时出现上下抖动）
- 竞争：对于多路信号，在若干信号同时改变时会引起竞争。在竞争的条件下，电路的动作取决于信号变化的实际次序。包括非临界竞争（电路仍转到正确状态），临界竞争（电路不能转到正确状态）
- 延时种类：传输延迟($\Delta T$ )、上升下降延迟、模糊延迟、惯性延迟($\Delta I$)
- 将 $\Delta I$ 与 $\Delta T$ 比较, 可知 $\Delta I$ 确定的是输入脉冲需要的最小持续时间, 或者说确定了输入脉冲 的最大频率 $f \leqslant (1 / 2 \Delta I)$ 。 当 $f>1 / 2 \Delta I$, 则输出不能变化; 当脉冲宽度 $T \geqslant \Delta I$ 时, $\Delta I=\Delta T$, 如果 $T<\Delta I$, 则根本谈不上 $\Delta T$ 。
- 三值模拟：0，1，μ；可以用于冒险的检测
- 五值模拟：0，1，0-1，1-0，u
- 八值模拟：0，1，无冒险0-1，无冒险1-0，静态0冒险，静态1冒险，动态冒险0-1，动态冒险1-0
- 九值模拟：用于故障模拟，建立在三值的基础上增加正常状态值和故障状态值
- 模拟程序结构：硬件抽象层、设备驱动层、硬件控制层的桥接
  - 编译法：执行速度快，不能模拟电路的冒险和竞争，需要加入延迟元件
  - 驱动面向事件单位延迟模拟：任意元件只有其输入信号发生变化才进行模拟
- 故障测试：完全测试、功能测试
- s-a-1：stuck at 1，Z的结果不受A的变化影响，且最后的输出结果体现为A=1（个人理解）
- 故障冗余：在测试中不用考虑，但仍需要用固定信号将其固化
- 固定型故障、桥接故障（元件输入端之间的桥接故障，反馈桥接）
  **路径敏化法**
- 反映故障——传播故障——确定输入——测试输入（单路径敏化求不出可以用多通路敏化求）
  **D-算法**
- 奇异立方的定义、$D$ 表示正常电路值为1故障为0，$\overline{D}$ 表示正常电路值为0故障为1，$D+\overline{D}=1$
- 原始立方——用最少的变量实现一个输出
- 故障原始 D-立方——反映故障的最小条件
- 传播-立方——表示将故障进行传播
- 算法：建立故障原始立方 - 敏化输出路径（故障传播） - 一致性操作（导出相应的初级输入）
> 驱动：选择 s-a 故障原始立方 ---- 和各种传播立方求交集
> 一致性操作：和各种原始立方求交集

## Chapter5：CAD版图设计基础

自动布图设计采用分级处理的方式，（布图或称逻辑划分Partition）是将电路按功能块进行逐级分级，直到便于设计；然后将划分后的电路子块以某种方式进行排列（布局placement），最后对 排成的电路子块进行连线（布线Routing）
### 逻辑划分
**逻辑划分的原则**
- 逻辑功能块的功能完整性：每个模块完成一定的功能，即模块对应的子电路在电学上、 逻辑上是相对独立的。
- 连线尽量在模块内实现：使每个模块的内部均有较强的连接关系，同时使模块间有尽量弱的连接关系。$$S(A_i)\le S_\max\qquad E(A_i)\le E_{\max}$$
**简单连接度法**
简单连接度法既是一个 Bottom up 的结群算 法，也是一种最大结合-最小不结合在完成核
心单元及其模块划分后的局部划分方法。若用 $B(A_i)$ 表示单元 $A_i$ 所有的外部连接集合，则 $Con(A_i,A_j)$ 表示其连接度，$Dis(A_i,A_j)$ 表示其分离度
- Init：寻找一个与其他单元关系最差的单元加入本是空集的 $A_i$
- Loop：在 $A$ 中取出一个最相关的/和其他单元有弱连接的加入并检查面积和出线端限制
- End：$A$ 为空集
**其他**
- 通道界定
- I/O和电源规划
- 时钟规划

### 布局
几何要求、拓扑要求——保证100%能完成布线、关键线网的最小化延迟、使芯片上放置的单元尽可能紧密、最小化能量耗散、最小化信号间的交叉
**安置规则的布局**
利用最小生成树进行判断，一般选择外围，因为中间会阻挡布线

### 布线
通常将布线分成总体布线和详细布线两部分；另外根据对象的不同又可分为面向线网的布线和面向通道的布线；根据布线区域也可以分为门间布线与通道布线。
- 垂直约束图是对竖直方向的限制，那么对水平方向的约束就是通道区布线的水平限制条件， 可描述为在任何一个可行的布线中，不同线网的水平线段不允许发生重迭。

**无约束左端算法**
- 各线网间不存在垂直约束关系，每个线网在通道内只有一条水平线。
- 只要决定这个水平线的位置，便完成了该线网的安置。 因为不存在垂直约束，两个线网的垂直线不会相交。垂直线可以从出线端所在列连接所对应的水平线。

### 自动布图包含哪些内容，分别涉及哪些常用的算法？ 
自动布图包含逻辑划分、布局、布线和设计检查。
- 逻辑划分涉及最大结合-最小不解和法、丛生法、反复改进法、自下而上的结群算法和简单连接度法。 
- 布局涉及结构法（常用的有丛生法、以力学模型为基础的方法、对分法、利用逻辑电路图里的信号流方法和随机布局法）和反复改进法（常用的有成对交换法、重心缓和法、斯坦伯格方法）。典型的布局迭代改善算法有成对交换法、力间松弛法与最小切割法等。 布
- 线中总体布线涉及迷宫布线算法、李氏算法、海塔算法和线网分配；通道布线涉及无约束和有约束的左端算法。

### 如何处理总体布线和通道布线的关系，李氏算法主要解决什么问题。
总体布线是线网在各通道内的分配，通道布线则是线网在通道中的排列方式和布线顺序。 李氏算法主要寻找两点间的最短路径，解决的是总体布线问题。
